<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="book">
	<select id="list" resultType="BookDto">
		select * from book order by book_id asc
	</select>
	<select id="selectOne" resultType="BookDto">
		select * from book where book_id = #{bookId}
	</select>
	<insert id="add">
		insert into book(book_id, book_title, book_author,
		book_publication_date, book_price, book_publisher,
		book_page_count, book_genre)
		values(book_seq.nextval,#{book_title},#{book_author}
		,#{book_publication_date},#{book_price},#{book_publisher},#{book_page_count}
		,#{book_genre})
	</insert>
	<update id="update">
		update book set book_title=#{book_title}, book_author=#{book_author},
		book_publication_date=#{book_publication_date}, book_price=#{book_price}
		, book_publisher=#{book_publisher},
		book_page_count=#{book_page_count}, book_genre=#{book_genre} where book_id=#{book_id}
	</update>
	<delete id="remove">
		delete book where book_id = #{bookId}
	</delete>
<!-- 도서 검색
-type, keyword 검색에서 type과 keyword는 할당되는 방식이 달라야 한다
- type은 있는 그대로 변형 없이 할당(정적 할당)
- keyword는 데이터의 형태에 맞게 변형하여 할당(동적 할당)
 -->
	<select id="search" resultType="BookDto">
		select * from book where instr(${type},#{keyword}) >0
	</select>
</mapper>